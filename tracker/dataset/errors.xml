<!--
     This dataset provides a list of the errors that have occurred.
     First REST parameter can be the application, if so wanted.

     Errors are returned latest error first.
  -->

<dataset read="*" write="">
    <select>
        SELECT
            id,
            sid,
            app_name,
            username,
            group_list,
            dataset,
            action,
            params,
            post_body,
            message,
            strftime('%Y-%m-%dT%H:%M:%S', start_time)  AS start_time
        FROM
            error
        WHERE
            ({$1} IS NULL OR lower(app_name) = lower({$1}))
            AND
            (
                {$filter} IS NULL OR {$filter} = ''
                OR
                id IN (SELECT id FROM error WHERE sid LIKE '%' || {$filter} || '%')
                OR
                id IN (SELECT id FROM error WHERE username LIKE '%' || {$filter} || '%')
                OR
                id IN (SELECT id FROM error WHERE dataset LIKE '%' || {$filter} || '%')
                OR
                id IN (SELECT id FROM error WHERE params LIKE '%' || {$filter} || '%')
                OR
                id IN (SELECT id FROM error WHERE message LIKE '%' || {$filter} || '%')
                OR
                id IN (SELECT id FROM error WHERE post_body LIKE '%' || {$filter} || '%')
            )
        ORDER BY
            start_time DESC

    </select>
</dataset>
