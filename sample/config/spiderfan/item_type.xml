<dataset serial="id" read="*" write="admin">
    <select>
SELECT id, dirname, heading, intro,
    COALESCE (forced_title, '') AS forced_title,
    owner,
    needs_image
FROM item_type
ORDER BY heading
    </select>
    <update>
UPDATE item_type
SET dirname = BTRIM ({{dirname}}),
    heading = BTRIM ({{heading}}),
    intro = BTRIM ({{intro}}),
    forced_title = NULLIF (BTRIM ({{forced_title}}), ''),
    owner = {{owner}},
    needs_image = {{needs_image}},
    change_user = {{__username}},
    change_date = now()
WHERE id = {{id}};
    </update>
    <insert>
INSERT INTO item_type (section, note, change_user, change_date)
VALUES (BTRIM ({{section}}), BTRIM ({{note}}), {{__username}}, now());
    
INSERT INTO item_type (dirname, heading, intro, forced_title,
    owner, needs_image, change_user, change_date)
VALUES (BTRIM ({{dirname}}), BTRIM ({{heading}}), BTRIM ({{intro}}),
    NULLIF (BTRIM ({{forced_title}}), ''), {{owner}},
    needs_image, change_user, now());
    </insert>
    <delete>
DELETE FROM item_type
WHERE id = {{id}};
    </delete>
</dataset>
